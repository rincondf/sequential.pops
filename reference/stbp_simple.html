<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Sequential test of Bayesian posterior probabilities for simple hypotheses about species absence — stbp_simple • sequential.pops</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Sequential test of Bayesian posterior probabilities for simple hypotheses about species absence — stbp_simple"><meta name="description" content="Runs a Sequential test of Bayesian Posterior Probabilities for hypotheses
about species absence of the form \(H:\mu = 0\). Data is treated in a
sequential framework."><meta property="og:description" content="Runs a Sequential test of Bayesian Posterior Probabilities for hypotheses
about species absence of the form \(H:\mu = 0\). Data is treated in a
sequential framework."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">sequential.pops</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Seq-vignette.html">Sequential testing of hypotheses about population density with the `sequential.pops` package</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/rincondf/sequential.pops/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Sequential test of Bayesian posterior probabilities for simple hypotheses about species absence</h1>
      <small class="dont-index">Source: <a href="https://github.com/rincondf/sequential.pops/blob/master/R/STBP.R" class="external-link"><code>R/STBP.R</code></a></small>
      <div class="d-none name"><code>stbp_simple.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Runs a Sequential test of Bayesian Posterior Probabilities for hypotheses
about species absence of the form \(H:\mu = 0\). Data is treated in a
sequential framework.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">stbp_simple</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">density_func</span>,</span>
<span>  overdispersion <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  prior <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  upper_bnd <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>  <span class="va">lower_criterion</span>,</span>
<span>  <span class="va">upper_criterion</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>For count data, either a vector (for purely sequential designs) o
a matrix (group sequential designs) with sequential count data, with sampling
bouts collected over time in columns and samples within bouts in rows. NAs
are allowed in case sample size within bouts is unbalanced. For binomial
data, a list of matrices with integer non-negative values of observations
in col 1 and number of samples in col 2, so that each matrix within the list
corresponds to a sampling bout. NAs are <em>not</em> allowed for binomial data.</p></dd>


<dt id="arg-density-func">density_func<a class="anchor" aria-label="anchor" href="#arg-density-func"></a></dt>
<dd><p>Kernel probability density function for the data. See details.</p></dd>


<dt id="arg-overdispersion">overdispersion<a class="anchor" aria-label="anchor" href="#arg-overdispersion"></a></dt>
<dd><p>A character string (if a function) or a number
specifying the overdispersion parameter. Only required when using
<code>"negative binomial"</code> or <code>"beta-binomial"</code> as kernel densities.
See details.</p></dd>


<dt id="arg-prior">prior<a class="anchor" aria-label="anchor" href="#arg-prior"></a></dt>
<dd><p>Single number with initial prior. Must be in the interval \([0,1]\).</p></dd>


<dt id="arg-upper-bnd">upper_bnd<a class="anchor" aria-label="anchor" href="#arg-upper-bnd"></a></dt>
<dd><p>Single number indicating the greatest possible value for \(\mu\).
For count data, is often <code>Inf</code> (default), but it must be \(\leq 1\)
for binomial data.</p></dd>


<dt id="arg-lower-criterion">lower_criterion<a class="anchor" aria-label="anchor" href="#arg-lower-criterion"></a></dt>
<dd><p>Criterion to decide against the tested hypothesis.
This is the lowest credibility to the hypothesis to stop sampling and decide
against.</p></dd>


<dt id="arg-upper-criterion">upper_criterion<a class="anchor" aria-label="anchor" href="#arg-upper-criterion"></a></dt>
<dd><p>Criterion to decide in favor of the tested hypothesis.
This is the greatest credibility to the hypothesis to stop sampling and decide
in favor.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of class <code>"STBP"</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The <code>density_func</code> argument should be specified as character string.
Acceptable options are <code>"poisson"</code>, <code>"negative binomial"</code>,
<code>"binomial"</code> and <code>"beta-binomial"</code>. The overdispersion
parameter for <code>"negative binomial"</code> and <code>"beta-binomial"</code> can be
either a constant or a function of the mean.</p>
<p>If a function, it should be specified as a character string with the name of
an existing function. For options of empirical functions to describe
overdispersion as a function of the mean see Binns et al. (2000). The most
common approach for the negative binomial family is Taylor's Power Law, which
describes the variance as a function of the mean with two parameters, \(a\)
and \(b\). Overdispersion, \(k\), can then be specified as: $$k = \frac{\mu^2}{a \mu^b - \mu}$$</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Binns, M.R., Nyrop, J.P. &amp; Werf, W.v.d. (2000) <em>Sampling and
monitoring in crop protection: the theoretical basis for developing practical
decision guides</em>. CABI Pub., Wallingford, Oxon, UK; New York, N.Y.</p>
<p>Rincon, D.F., McCabe, I. &amp; Crowder, D.W. (2025) Sequential testing of
complementary hypotheses about population density. <em>Methods in Ecology
and Evolution</em>. &lt;https://doi.org/10.1111/2041-210X.70053&gt;</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Testing the absence of a species in a given area from a sequential random</span></span></span>
<span class="r-in"><span><span class="co"># sampling of 3 bouts made of 10 samples (counts) each (all absences). Upper</span></span></span>
<span class="r-in"><span><span class="co"># criterion set to 0.9999</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">counts10</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">30</span><span class="op">)</span>, <span class="fl">10</span>, <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">test1G</span> <span class="op">&lt;-</span> <span class="fu">stbp_simple</span><span class="op">(</span>data <span class="op">=</span> <span class="va">counts10</span>,</span></span>
<span class="r-in"><span>                        density_func <span class="op">=</span> <span class="st">"poisson"</span>,</span></span>
<span class="r-in"><span>                        prior <span class="op">=</span> <span class="fl">0.5</span>,</span></span>
<span class="r-in"><span>                        upper_bnd <span class="op">=</span> <span class="cn">Inf</span>,</span></span>
<span class="r-in"><span>                        lower_criterion <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>                        upper_criterion <span class="op">=</span> <span class="fl">0.9999</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">test1G</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sequential test of Bayesian posterior probabilities</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Family: poisson</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> H: mu = 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Probability: 0.999 from 3 sampling bouts</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Recommendation based on provided criteria: keep sampling</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># returns a recommendation of "keep sampling" due to insufficient evidence.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Testing the same hypothesis with the same upper criterion but from a</span></span></span>
<span class="r-in"><span><span class="co"># sequential random sampling of 3 bouts made of 30 samples (counts) each</span></span></span>
<span class="r-in"><span><span class="co"># (all absences).</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">counts30</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">90</span><span class="op">)</span>, <span class="fl">30</span>, <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">test2G</span> <span class="op">&lt;-</span> <span class="fu">stbp_simple</span><span class="op">(</span>data <span class="op">=</span> <span class="va">counts30</span>,</span></span>
<span class="r-in"><span>                        density_func<span class="op">=</span> <span class="st">"poisson"</span>,</span></span>
<span class="r-in"><span>                        prior <span class="op">=</span> <span class="fl">0.5</span>,</span></span>
<span class="r-in"><span>                        upper_bnd <span class="op">=</span> <span class="cn">Inf</span>,</span></span>
<span class="r-in"><span>                        lower_criterion <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>                        upper_criterion <span class="op">=</span> <span class="fl">0.9999</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">test2G</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sequential test of Bayesian posterior probabilities</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Family: poisson</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> H: mu = 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Probability: 0.99996 from 3 sampling bouts</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Recommendation based on provided criteria: accept H</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># returns a recommendation of "accept H" of the species being absent from</span></span></span>
<span class="r-in"><span><span class="co"># that area.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## End (Not run)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Diego F Rincon, Izzy McCabe, David W Crowder.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

