<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Evaluation of Sequential probability ratio tests — SPRT.eval • sequential.pops</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Evaluation of Sequential probability ratio tests — SPRT.eval"><meta name="description" content='Obtains the average number of sampling bouts and the rate of acceptance for
\(H_{1}\), from a sequential test of \(H_{0}:\mu = \psi_{0}\) vs.
\(H_{1}:\mu &amp;lt; \psi_{1}\) across a range of true population densities,
based on simulations. Sometimes called "operating characteristics".'><meta property="og:description" content='Obtains the average number of sampling bouts and the rate of acceptance for
\(H_{1}\), from a sequential test of \(H_{0}:\mu = \psi_{0}\) vs.
\(H_{1}:\mu &amp;lt; \psi_{1}\) across a range of true population densities,
based on simulations. Sometimes called "operating characteristics".'><meta property="og:image" content="https://rincondf.github.io/sequential.pops/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">sequential.pops</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Seq-vignette.html">Sequential testing of hypotheses about population density with the `sequential.pops` package</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/rincondf/sequential.pops/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Evaluation of Sequential probability ratio tests</h1>
      <small class="dont-index">Source: <a href="https://github.com/rincondf/sequential.pops/blob/master/R/SPRT-eval.R" class="external-link"><code>R/SPRT-eval.R</code></a></small>
      <div class="d-none name"><code>SPRT.eval.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Obtains the average number of sampling bouts and the rate of acceptance for
\(H_{1}\), from a sequential test of \(H_{0}:\mu = \psi_{0}\) vs.
\(H_{1}:\mu &lt; \psi_{1}\) across a range of true population densities,
based on simulations. Sometimes called "operating characteristics".</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">SPRT.eval</span><span class="op">(</span><span class="va">obj</span>, <span class="va">eval.range</span>, overdispersion.sim <span class="op">=</span> <span class="cn">NA</span>, <span class="va">N</span>, seed <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-obj">obj<a class="anchor" aria-label="anchor" href="#arg-obj"></a></dt>
<dd><p>An object of class <code>"SPRT"</code>.</p></dd>


<dt id="arg-eval-range">eval.range<a class="anchor" aria-label="anchor" href="#arg-eval-range"></a></dt>
<dd><p>A vector with a sequence of true population densities to
evaluate.</p></dd>


<dt id="arg-overdispersion-sim">overdispersion.sim<a class="anchor" aria-label="anchor" href="#arg-overdispersion-sim"></a></dt>
<dd><p>A character string (if a function) or a non-negative number
specifying the overdispersion parameter used to generate simulated counts.
Only required when using <code>"negative binomial"</code> or <code>"beta-binomial"</code>
as kernel densities. See details.</p></dd>


<dt id="arg-n">N<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>Number of simulations per true population density being evaluated.</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>Optional seed for random count generation.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list with the average number of sampling bouts required to reach a decision
(<code>$AvgSamples</code>), and the rate of acceptance for \(H_{1}\) across
the provided range of population densities (<code>$AcceptRate</code>).</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The kernel probability density function to evaluate the test is that specified in the
argument <code>density_func</code> to create the <code>"SPRT"</code> object, but overdispersion
can be different to generate simulated counts. If <code>"negative binomial"</code> is used
as kernel density for the test and <code>overdispersion.sim</code> is not specified (NA),
then the same specification of the test is used to generate the counts. Ideally,
overdispersion for simulations should include uncertainty about the parameter to
produce more robust test evaluations. For example, if using a <code>negative binomial</code> kernel
and the Taylor's Power Law approach to obtain overdispersion, then overdispersion for
simulations should be specified as: $$k = \frac{\mu^2}{a \mu^b e^z - \mu}$$ where \(k\)
is the overdispersion parameter of the negative binomial distribution, \(a\) and \(b\)
are parameters of the Taylor's Power Law and \(z\) is a normally distributed
variable with mean \(0\) and standard deviation \(\sigma_{e}\), which is the root
of the mean square error for the regression used to estimate \(a\) and \(b\). See
examples.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Binns, M.R., Nyrop, J.P. &amp; Werf, W.v.d. (2000) <em>Sampling and
monitoring in crop protection: the theoretical basis for developing practical
decision guides</em>. CABI Pub., Wallingford, Oxon, UK; New York, N.Y.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Function that describes negative binomial overdisperion from the mean</span></span></span>
<span class="r-in"><span><span class="co"># and Taylor's Power Law parameters, a and b:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">estimate_k</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">mean</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>                        <span class="va">a</span> <span class="op">=</span> <span class="fl">1.830012</span></span></span>
<span class="r-in"><span>                        <span class="va">b</span> <span class="op">=</span> <span class="fl">1.218041</span> <span class="co"># a and b are Taylor's Power Law parameters</span></span></span>
<span class="r-in"><span>                        <span class="op">(</span><span class="va">mean</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="op">(</span><span class="va">a</span> <span class="op">*</span> <span class="va">mean</span><span class="op">^</span><span class="op">(</span><span class="va">b</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="va">mean</span><span class="op">)</span></span></span>
<span class="r-in"><span>                       <span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate a SPRT object with negative binomial and varying overdispersion</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">counts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">2</span>, <span class="fl">7</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">test11</span> <span class="op">&lt;-</span> <span class="fu"><a href="sprt.html">sprt</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">counts</span>,</span></span>
<span class="r-in"><span>                mu0 <span class="op">=</span> <span class="fl">8</span>,</span></span>
<span class="r-in"><span>                mu1 <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>                density_func <span class="op">=</span> <span class="st">"negative binomial"</span>,</span></span>
<span class="r-in"><span>                overdispersion <span class="op">=</span> <span class="fu">estimate_k</span><span class="op">(</span><span class="fl">9</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                alpha <span class="op">=</span> <span class="fl">0.1</span>,</span></span>
<span class="r-in"><span>                beta <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Stochastic version of 'estimate k', where sd here is the the root of the</span></span></span>
<span class="r-in"><span><span class="co"># mean square error for the regression used to estimate a and b.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">estimate_k_stoch</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">mean</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>                              <span class="va">a</span> <span class="op">&lt;-</span> <span class="fl">1.830012</span></span></span>
<span class="r-in"><span>                              <span class="va">b</span> <span class="op">&lt;-</span> <span class="fl">1.218041</span></span></span>
<span class="r-in"><span>                              <span class="op">(</span><span class="va">mean</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">/</span></span></span>
<span class="r-in"><span>                                <span class="op">(</span><span class="op">(</span><span class="va">a</span> <span class="op">*</span> <span class="va">mean</span><span class="op">^</span><span class="op">(</span><span class="va">b</span><span class="op">)</span> <span class="op">*</span></span></span>
<span class="r-in"><span>                                  <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu">truncdist</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/truncdist/man/rtrunc.html" class="external-link">rtrunc</a></span><span class="op">(</span><span class="fl">1</span>,</span></span>
<span class="r-in"><span>                                                        <span class="st">"norm"</span>,</span></span>
<span class="r-in"><span>                                                        a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="va">a</span> <span class="op">*</span> <span class="va">mean</span><span class="op">^</span><span class="op">(</span><span class="va">b</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                                        b <span class="op">=</span> <span class="cn">Inf</span>,</span></span>
<span class="r-in"><span>                                                        mean <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>                                                        sd <span class="op">=</span> <span class="fl">0.3222354</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>                                         <span class="op">-</span> <span class="va">mean</span><span class="op">)</span></span></span>
<span class="r-in"><span>                                   <span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Run model evaluation for test11 with varying overdispersion and</span></span></span>
<span class="r-in"><span><span class="co"># added stochasticity.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">eval4</span> <span class="op">&lt;-</span> <span class="fu">SPRT.eval</span><span class="op">(</span><span class="va">test11</span>, eval.range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">13</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    overdispersion.sim <span class="op">=</span> <span class="st">"estimate_k_stoch"</span>, N <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in estimate_k_stoch(pop_mean):</span> could not find function "estimate_k_stoch"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot-STBP-missing-method.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">13</span><span class="op">)</span>, <span class="va">eval4</span><span class="op">$</span><span class="va">AvgSamples</span>, type <span class="op">=</span> <span class="st">"o"</span>, xlab <span class="op">=</span> <span class="st">"True population size"</span>,</span></span>
<span class="r-in"><span>      ylab <span class="op">=</span> <span class="st">"Average number of bouts"</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in h(simpleError(msg, call)):</span> error in evaluating the argument 'y' in selecting a method for function 'plot': object 'eval4' not found</span>
<span class="r-in"><span><span class="fu"><a href="plot-STBP-missing-method.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">13</span><span class="op">)</span>, <span class="va">eval4</span><span class="op">$</span><span class="va">AcceptRate</span>, type <span class="op">=</span> <span class="st">"o"</span>, xlab <span class="op">=</span> <span class="st">"True population size"</span>,</span></span>
<span class="r-in"><span>      ylab <span class="op">=</span> <span class="st">"Acceptance rate of H1"</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in h(simpleError(msg, call)):</span> error in evaluating the argument 'y' in selecting a method for function 'plot': object 'eval4' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## End (Not run)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Diego F Rincon, Izzy McCabe, David W Crowder.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

