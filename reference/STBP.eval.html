<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Evaluation of Sequential tests of Bayesian posterior probabilities — STBP.eval • sequential.pops</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Evaluation of Sequential tests of Bayesian posterior probabilities — STBP.eval"><meta name="description" content='Obtains the average number of sampling bouts and the rate of acceptance for
\(H:\mu &amp;gt; \psi\) or \(H:\mu &amp;lt; \psi\) across a range of true population
densities, based on simulations. Sometimes called "operating characteristics".'><meta property="og:description" content='Obtains the average number of sampling bouts and the rate of acceptance for
\(H:\mu &amp;gt; \psi\) or \(H:\mu &amp;lt; \psi\) across a range of true population
densities, based on simulations. Sometimes called "operating characteristics".'><meta property="og:image" content="https://rincondf.github.io/sequential.pops/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">sequential.pops</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Seq-vignette.html">Sequential testing of hypotheses about population density with the `sequential.pops` package</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/rincondf/sequential.pops/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Evaluation of Sequential tests of Bayesian posterior probabilities</h1>
      <small class="dont-index">Source: <a href="https://github.com/rincondf/sequential.pops/blob/master/R/STBP-eval.R" class="external-link"><code>R/STBP-eval.R</code></a></small>
      <div class="d-none name"><code>STBP.eval.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Obtains the average number of sampling bouts and the rate of acceptance for
\(H:\mu &gt; \psi\) or \(H:\mu &lt; \psi\) across a range of true population
densities, based on simulations. Sometimes called "operating characteristics".</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">STBP.eval</span><span class="op">(</span><span class="va">obj</span>, <span class="va">eval.range</span>, <span class="va">n</span>, <span class="va">prior</span>, overdispersion.sim <span class="op">=</span> <span class="cn">NA</span>, <span class="va">N</span>, seed <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-obj">obj<a class="anchor" aria-label="anchor" href="#arg-obj"></a></dt>
<dd><p>An object of class <code>"STBP"</code>.</p></dd>


<dt id="arg-eval-range">eval.range<a class="anchor" aria-label="anchor" href="#arg-eval-range"></a></dt>
<dd><p>The evaluation range. A vector with a sequence of true population
densities to evaluate. If the <code>hypothesis</code> argument in the test is a trajectory
(i.e., a vector), the evaluation range is a factor of the hypothesized trajectory.
See details.</p></dd>


<dt id="arg-n">n<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>Sample size within bouts.</p></dd>


<dt id="arg-prior">prior<a class="anchor" aria-label="anchor" href="#arg-prior"></a></dt>
<dd><p>Single number with initial prior. Must be on the interval
\([0,1]\).</p></dd>


<dt id="arg-overdispersion-sim">overdispersion.sim<a class="anchor" aria-label="anchor" href="#arg-overdispersion-sim"></a></dt>
<dd><p>A character string (if a function) or a a non-negative number
specifying the overdispersion parameter used to generate simulated counts.
Only required when using <code>"negative binomial"</code> or <code>"beta-binomial"</code>
as kernel densities. See details.</p></dd>


<dt id="arg-n">N<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>Number of simulations per true population density or trajectory being evaluated.</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>Optional seed for random count generation.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list with the average number of sampling bouts required to reach a
decision (<code>$AvgSamples</code>), and the rate of acceptance for \(H\) across
the provided range of population densities (<code>$AcceptRate</code>).</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The kernel probability density function to evaluate the test is that specified in the
argument <code>density_func</code> to create the <code>"STBP"</code> object, but overdispersion
can be different to generate simulated counts. If <code>"negative binomial"</code> or
<code>"beta-binomial"</code> are used as kernel densities for the test and
<code>overdispersion.sim</code> is not specified (NA), then the same specification of the test
is used to generate the counts. Ideally, overdispersion for simulations should include
uncertainty about the parameter to produce more robust test evaluations. For example,
if using a <code>negative binomial</code> kernel and the Taylor's Power Law approach
to obtain overdispersion, then overdispersion for simulations should be specified
as: $$k = \frac{\mu^2}{a \mu^b e^z - \mu}$$ where \(k\) is the overdispersion
parameter of the negative binomial distribution, \(a\) and \(b\) are parameters
of the Taylor's Power Law and \(z\) is a normally distributed variable with mean \(0\)
and standard deviation \(\sigma_{e}\), which is the root of the mean square error
for the regression used to estimate \(a\) and \(b\). See examples.</p>
<p>The evaluation range in the <code>eval.range</code> argument should cover relevant population
densities for which the test will be applied. These densities are often around the
threshold to check sampling sizes and error rates at those critical levels. In the case
of dynamic hypotheses (vectors), the range should be given as factors of the hypothesized
trajectory. For example, to evaluate this test for a hypothesis trajectory the
<code>eval.range</code> argument could be <code>seq(0.1, 2, 0.1)</code>, so the evaluation runs from
\(10\) percent of the trajectory to twice the trajectory in \(10\) percent increments.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Binns, M.R., Nyrop, J.P. &amp; Werf, W.v.d. (2000) <em>Sampling and
monitoring in crop protection: the theoretical basis for developing practical
decision guides</em>. CABI Pub., Wallingford, Oxon, UK; New York, N.Y.</p>
<p>Rincon, D.F., McCabe, I. &amp; Crowder, D.W. (2025) Sequential testing of
complementary hypotheses about population density. <em>Methods in Ecology
and Evolution</em>. &lt;https://doi.org/10.1111/2041-210X.70053&gt;</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># These examples are run with very few simulation runs (argument N), so they</span></span></span>
<span class="r-in"><span><span class="co"># provide unrealistic results. For more reasonable demonstrations check the</span></span></span>
<span class="r-in"><span><span class="co"># vignettes.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Assuming a negative binomial count variable whose overdispersion parameter,</span></span></span>
<span class="r-in"><span><span class="co"># k, varies as a function of the mean, and that the variance-mean relationship</span></span></span>
<span class="r-in"><span><span class="co"># is well described with Taylor's Power Law, a function to obtain k can be:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">estimate_k</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">mean</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>                        <span class="va">a</span> <span class="op">=</span> <span class="fl">1.830012</span></span></span>
<span class="r-in"><span>                        <span class="va">b</span> <span class="op">=</span> <span class="fl">1.218041</span> <span class="co"># a and b are Taylor's Power Law parameters</span></span></span>
<span class="r-in"><span>                        <span class="op">(</span><span class="va">mean</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="op">(</span><span class="va">a</span> <span class="op">*</span> <span class="va">mean</span><span class="op">^</span><span class="op">(</span><span class="va">b</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="va">mean</span><span class="op">)</span></span></span>
<span class="r-in"><span>                        <span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate some counts to create an STBP object with the model specifications</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">counts3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/NegBinomial.html" class="external-link">rnbinom</a></span><span class="op">(</span><span class="fl">20</span>, mu <span class="op">=</span> <span class="fl">5</span>, size <span class="op">=</span> <span class="fu">estimate_k</span><span class="op">(</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Run the test to create the STBP object</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">test1F</span> <span class="op">&lt;-</span> <span class="fu"><a href="stbp_composite.html">stbp_composite</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">counts3</span>,</span></span>
<span class="r-in"><span>                          greater_than <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                          hypothesis <span class="op">=</span> <span class="fl">9</span>,</span></span>
<span class="r-in"><span>                          density_func <span class="op">=</span> <span class="st">"negative binomial"</span>,</span></span>
<span class="r-in"><span>                          overdispersion <span class="op">=</span> <span class="st">"estimate_k"</span>,</span></span>
<span class="r-in"><span>                          prior <span class="op">=</span> <span class="fl">0.5</span>,</span></span>
<span class="r-in"><span>                          lower_bnd <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>                          upper_bnd <span class="op">=</span> <span class="cn">Inf</span>,</span></span>
<span class="r-in"><span>                          lower_criterion <span class="op">=</span> <span class="fl">0.01</span>,</span></span>
<span class="r-in"><span>                          upper_criterion <span class="op">=</span> <span class="fl">0.99</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in estimate_k(x):</span> could not find function "estimate_k"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">test1F</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> object 'test1F' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Model evaluation is carried out based on simulated counts, and more realistic</span></span></span>
<span class="r-in"><span><span class="co"># counts could be generated if uncertainty about the overdispersion parameter is</span></span></span>
<span class="r-in"><span><span class="co"># considered. A function to obtain values for the overdispersion parameter, k,</span></span></span>
<span class="r-in"><span><span class="co"># with added stochasticity could be (following Binns et al. 2000):</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">estimate_k_stoch</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">mean</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>                              <span class="va">a</span> <span class="op">&lt;-</span> <span class="fl">1.830012</span></span></span>
<span class="r-in"><span>                              <span class="va">b</span> <span class="op">&lt;-</span> <span class="fl">1.218041</span></span></span>
<span class="r-in"><span>                              <span class="op">(</span><span class="va">mean</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">/</span></span></span>
<span class="r-in"><span>                                <span class="op">(</span><span class="op">(</span><span class="va">a</span> <span class="op">*</span> <span class="va">mean</span><span class="op">^</span><span class="op">(</span><span class="va">b</span><span class="op">)</span> <span class="op">*</span></span></span>
<span class="r-in"><span>                                  <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu">truncdist</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/truncdist/man/rtrunc.html" class="external-link">rtrunc</a></span><span class="op">(</span><span class="fl">1</span>,</span></span>
<span class="r-in"><span>                                                        <span class="st">"norm"</span>,</span></span>
<span class="r-in"><span>                                                        a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="va">a</span> <span class="op">*</span> <span class="va">mean</span><span class="op">^</span><span class="op">(</span><span class="va">b</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                                        b <span class="op">=</span> <span class="cn">Inf</span>,</span></span>
<span class="r-in"><span>                                                        mean <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>                                                        sd <span class="op">=</span> <span class="fl">0.3222354</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>                                         <span class="op">-</span> <span class="va">mean</span><span class="op">)</span></span></span>
<span class="r-in"><span>                                   <span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># where sd here is the the root of the mean square error for the regression</span></span></span>
<span class="r-in"><span><span class="co"># used to estimate a and b. Note that this is a stochastic version</span></span></span>
<span class="r-in"><span><span class="co"># of 'estimate_k'.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Run model evaluation for testF1 with varying overdispersion and</span></span></span>
<span class="r-in"><span><span class="co"># added stochasticity with very few simulations to save time.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">eval1</span> <span class="op">&lt;-</span> <span class="fu">STBP.eval</span><span class="op">(</span><span class="va">test1F</span>,</span></span>
<span class="r-in"><span>                    eval.range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">11</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    n <span class="op">=</span> <span class="fl">1</span>, prior <span class="op">=</span> <span class="fl">0.5</span>,</span></span>
<span class="r-in"><span>                    overdispersion.sim <span class="op">=</span> <span class="st">"estimate_k_stoch"</span>,</span></span>
<span class="r-in"><span>                    N <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> object 'test1F' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot-STBP-missing-method.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">11</span><span class="op">)</span>, <span class="va">eval1</span><span class="op">$</span><span class="va">AvgSamples</span>, type <span class="op">=</span> <span class="st">"o"</span>, xlab <span class="op">=</span> <span class="st">"True population size"</span>,</span></span>
<span class="r-in"><span>      ylab <span class="op">=</span> <span class="st">"Average number of bouts"</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in h(simpleError(msg, call)):</span> error in evaluating the argument 'y' in selecting a method for function 'plot': object 'eval1' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot-STBP-missing-method.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">11</span><span class="op">)</span>, <span class="va">eval1</span><span class="op">$</span><span class="va">AcceptRate</span>, type <span class="op">=</span> <span class="st">"o"</span>, xlab <span class="op">=</span> <span class="st">"True population size"</span>,</span></span>
<span class="r-in"><span>      ylab <span class="op">=</span> <span class="st">"Acceptance rate of H"</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in h(simpleError(msg, call)):</span> error in evaluating the argument 'y' in selecting a method for function 'plot': object 'eval1' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Alternatively, the evaluation could be carried out omitting variation about</span></span></span>
<span class="r-in"><span><span class="co"># overdispersion. For that the overdispersion argument is omitted and the same</span></span></span>
<span class="r-in"><span><span class="co"># specification of the model is used. Very few simulations to save time.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">eval2</span> <span class="op">&lt;-</span> <span class="fu">STBP.eval</span><span class="op">(</span><span class="va">test1F</span>,</span></span>
<span class="r-in"><span>                    eval.range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">11</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    n <span class="op">=</span> <span class="fl">1</span>, prior <span class="op">=</span> <span class="fl">0.5</span>,</span></span>
<span class="r-in"><span>                    N <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> object 'test1F' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot-STBP-missing-method.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">11</span><span class="op">)</span>, <span class="va">eval2</span><span class="op">$</span><span class="va">AvgSamples</span>, type <span class="op">=</span> <span class="st">"o"</span>, xlab <span class="op">=</span> <span class="st">"True population size"</span>,</span></span>
<span class="r-in"><span>      ylab <span class="op">=</span> <span class="st">"Average number of bouts"</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in h(simpleError(msg, call)):</span> error in evaluating the argument 'y' in selecting a method for function 'plot': object 'eval2' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot-STBP-missing-method.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">11</span><span class="op">)</span>, <span class="va">eval2</span><span class="op">$</span><span class="va">AcceptRate</span>, type <span class="op">=</span> <span class="st">"o"</span>, xlab <span class="op">=</span> <span class="st">"True population size"</span>,</span></span>
<span class="r-in"><span>      ylab <span class="op">=</span> <span class="st">"Acceptance rate of H"</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in h(simpleError(msg, call)):</span> error in evaluating the argument 'y' in selecting a method for function 'plot': object 'eval2' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># When there is no overdispersion (poisson or binomial distributions) the</span></span></span>
<span class="r-in"><span><span class="co"># procedure is much simpler</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">test2F</span> <span class="op">&lt;-</span> <span class="fu"><a href="stbp_composite.html">stbp_composite</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">counts3</span>,</span></span>
<span class="r-in"><span>                          greater_than <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                          hypothesis <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>                          density_func <span class="op">=</span> <span class="st">"poisson"</span>,</span></span>
<span class="r-in"><span>                          prior <span class="op">=</span> <span class="fl">0.5</span>,</span></span>
<span class="r-in"><span>                          lower_bnd <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>                          upper_bnd <span class="op">=</span> <span class="cn">Inf</span>,</span></span>
<span class="r-in"><span>                          lower_criterion <span class="op">=</span> <span class="fl">0.01</span>,</span></span>
<span class="r-in"><span>                          upper_criterion <span class="op">=</span> <span class="fl">0.99</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">test2F</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sequential test of Bayesian posterior probabilities</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Family: poisson</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> H: mu &gt; 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Probability: 1 from 17 sampling bouts</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Recommendation based on provided criteria: accept H</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Overdispersion is omitted here. Again, very few simulations (N) to save time.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">eval3</span> <span class="op">&lt;-</span> <span class="fu">STBP.eval</span><span class="op">(</span><span class="va">test2F</span>,</span></span>
<span class="r-in"><span>                  eval.range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">8</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                  n <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                  prior <span class="op">=</span> <span class="fl">0.5</span>, N <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot-STBP-missing-method.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">8</span><span class="op">)</span>, <span class="va">eval3</span><span class="op">$</span><span class="va">AvgSamples</span>, type <span class="op">=</span> <span class="st">"o"</span>, xlab <span class="op">=</span> <span class="st">"True population size"</span>,</span></span>
<span class="r-in"><span>      ylab <span class="op">=</span> <span class="st">"Average number of bouts"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="STBP.eval-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot-STBP-missing-method.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">8</span><span class="op">)</span>, <span class="va">eval3</span><span class="op">$</span><span class="va">AcceptRate</span>, type <span class="op">=</span> <span class="st">"o"</span>, xlab <span class="op">=</span> <span class="st">"True population size"</span>,</span></span>
<span class="r-in"><span>      ylab <span class="op">=</span> <span class="st">"Acceptance rate of H"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="STBP.eval-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Variations if n, the sample size within each bout, can also be changed</span></span></span>
<span class="r-in"><span><span class="co"># (not possible in SPRT)!</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## End (Not run)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Diego F Rincon, Izzy McCabe, David W Crowder.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

